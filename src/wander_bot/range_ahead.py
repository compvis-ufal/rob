#!/usr/bin/env python
import rospy
from sensor_msgs.msg import LaserScan

import numpy as np
import matplotlib.pyplot as plt

# Define angles to draw polar range data
theta = np.deg2rad(np.linspace(1, 360, 360))

plt.figure(1)

def scan_callback(msg):
    range_ahead = msg.ranges[len(msg.ranges)/2]
    print ("range ahead: %0.1f" % range_ahead)
    # r = np.array(msg.ranges)
    # print(r.shape)
    plt.polar(theta, msg.ranges)
    # plt.show()
    # print(range(len(msg.ranges)))
    # print(msg.ranges[0])
    # for i in range(len(msg.ranges)):
    	# print (msg.ranges[i])

rospy.init_node('range_ahead')

scan_sub = rospy.Subscriber('scan', LaserScan, scan_callback)

rospy.spin()


# #%% Example
# import numpy as np
# import matplotlib.pyplot as plt
# theta = np.deg2rad(np.linspace(90, 449, 360))
# r = [np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, 3.1033151149749756, 3.043306350708008, 3.0480329990386963, 2.056385040283203, 2.0030670166015625, 1.9769346714019775, 1.9675790071487427, 1.9704670906066895, 1.9691258668899536, 1.9971768856048584, 2.0362155437469482, np.inf, np.inf, 1.0264559984207153, 0.9948607087135315, 0.9814673662185669, 0.9444074630737305, 0.9560766816139221, 0.9444339871406555, 0.9325292110443115, 0.9487207531929016, 0.9290739893913269, 0.9600269794464111, 0.9420664310455322, 0.9309395551681519, 0.9418638348579407, 0.9698947668075562, 1.0076709985733032, 1.0588209629058838, 2.4946534633636475, 2.459230899810791, 2.4550857543945312, 2.463012456893921, 2.499202013015747, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, 1.785703182220459, 1.7347902059555054, 1.7251434326171875, 1.7118116617202759, 1.7092015743255615, 1.734330415725708, 1.7421746253967285, 1.7497426271438599, 1.8093996047973633, 3.372851610183716, 3.3520376682281494, 3.3287007808685303, 3.2953732013702393, 3.2799413204193115, 3.25276780128479, 3.2241878509521484, 3.203916311264038, 3.15864634513855, 2.940709352493286, 2.7515668869018555, 2.5896427631378174, 2.5731546878814697, 2.5839455127716064, 2.5575783252716064, 2.556927442550659, 2.532130479812622, 2.5342793464660645, 2.516040086746216, 2.523015022277832, 2.443641185760498, 2.336503267288208, 2.2642478942871094, 2.189574956893921, 2.106149673461914, 2.052793264389038, 2.005362033843994, 1.9455214738845825, 1.8727169036865234, 1.8292570114135742, 1.7723371982574463, 1.7326446771621704, 1.694667935371399, 1.6521637439727783, 1.6249502897262573, 1.6063799858093262, 1.5448256731033325, 1.5166175365447998, 1.4851453304290771, 1.4494751691818237, 1.4315468072891235, 1.3951705694198608, 1.3948651552200317, 1.3435126543045044, 1.3387529850006104, 1.3270246982574463, 1.31114661693573, 1.266676425933838, 1.2611340284347534, 1.2435846328735352, 1.2317540645599365, 1.2238218784332275, 1.2124816179275513, 1.1980464458465576, 1.1840890645980835, 1.1581186056137085, 1.1613783836364746, 1.1351895332336426, 1.1563223600387573, 1.1287964582443237, 1.1046390533447266, 1.102546215057373, 1.0953272581100464, 1.0733948945999146, 1.057160496711731, 1.0773600339889526, 1.0810141563415527, 1.0811411142349243, 1.052734136581421, 1.0284260511398315, 1.0519729852676392, 1.043922781944275, 1.0379196405410767, 1.0191770792007446, 1.0140533447265625, 1.0091952085494995, 0.9999402761459351, 1.0175364017486572, 1.0151780843734741, 1.0083593130111694, 1.0224857330322266, 1.01869797706604, 1.002016305923462, 0.9931204915046692, 1.0012285709381104, 0.9988952279090881, 0.986822247505188, 0.9580907821655273, 0.9424571394920349, 0.9077349305152893, 0.8932586908340454, 0.8737602233886719, 0.8558107614517212, 0.827835202217102, 0.8158616423606873, 0.7954288125038147, 0.7753865718841553, 0.7665387392044067, 0.7435209155082703, 0.7172654271125793, 0.7084063291549683, 0.7034420967102051, 0.6968998908996582, 0.6741094589233398, 0.6681341528892517, 0.6736072301864624, 0.6471349596977234, 0.6583208441734314, 0.6424508690834045, 0.6396425366401672, 0.6303176283836365, 0.5999200344085693, 0.6071133613586426, 0.5900703072547913, 0.5779580473899841, 0.573111891746521, 0.5868136882781982, 0.5615752935409546, 0.5666316151618958, 0.5682476758956909, 0.5619851350784302, 0.5501430034637451, 0.5440148711204529, 0.5442524552345276, 0.5479774475097656, 0.5578479170799255, 0.5293222069740295, 0.5246506333351135, 0.5327311158180237, 0.5276753306388855, 0.5010078549385071, 0.5185999870300293, 0.5317965745925903, 0.5130187273025513, 0.5059788227081299, 0.49766433238983154, 0.5265167951583862, 0.5132876038551331, 0.5106357932090759, 0.4948987364768982, 0.5180234909057617, 0.5076122879981995, 0.5056394934654236, 0.4865463972091675, 0.5113740563392639, 0.5133669972419739, 0.5057455897331238, 0.48741233348846436, 0.5020676851272583, 0.5027239918708801, 0.5014775395393372, 0.4932417869567871, 0.5132574439048767, 0.49927598237991333, 0.5160765051841736, 0.49276411533355713, 0.5032932162284851, 0.5280326008796692, 0.5261910557746887, 0.5411754250526428, 0.5270035862922668, 0.5132793188095093, 0.5213069915771484, 0.5207720398902893, 0.5225269794464111, 0.5349254608154297, 0.5397055149078369, 0.546364426612854, 0.5554971694946289, 0.5438739061355591, 0.5435733795166016, 0.5421032309532166, 0.5696295499801636, 0.573416531085968, 0.5636732578277588, 0.5812793374061584, 0.5965453386306763, 0.5663754940032959, 0.5941160321235657, 0.5932857394218445, 0.6146802306175232, 0.6304539442062378, 0.6280004382133484, 0.6369888782501221, 0.652733564376831, 0.6477234959602356, 0.6670143604278564, 0.6775453090667725, 0.6811797022819519, 0.6882873773574829, 0.7068080902099609, 0.722612202167511, 0.7411593794822693, 0.7507919073104858, 0.7751671671867371, 0.7690063118934631, 0.792123556137085, 0.8025832176208496, 0.8288635015487671, 0.8640204071998596, 0.868806004524231, 0.8946753144264221, 0.914956271648407, 0.9350680112838745, 0.9678936004638672, 0.9937179684638977, 1.0434057712554932, 1.055797815322876, 1.1052501201629639, 1.1270705461502075, 1.17136812210083, 1.2089064121246338, 1.2728643417358398, 1.335188627243042, 1.3828274011611938, 1.452467679977417, 1.5276678800582886, 1.5321749448776245, 1.5339502096176147, 1.5534987449645996, 1.563066005706787, 1.5600394010543823, 1.5545459985733032, 1.5740246772766113, 1.581181526184082, 1.6015828847885132, 1.6054461002349854, 1.620418667793274, 1.631878137588501, 1.6286895275115967, 1.9224673509597778, 2.275160551071167, 2.2785685062408447, 2.3080267906188965, 2.3097951412200928, 2.3748271465301514, 2.384202718734741, 2.418942451477051, 2.4240827560424805, 2.473513126373291, 2.4773285388946533, 2.5293939113616943, 2.56355357170105, 2.605832815170288, 2.621817111968994, 2.658334970474243, 2.711400270462036, 2.724731206893921, 2.785845994949341, 2.8480920791625977, 2.88505220413208, 2.951815366744995, 2.9782540798187256, 3.046226739883423, 3.106247663497925, 3.1727466583251953, 1.0842866897583008, 1.0287377834320068, 1.0031646490097046, 0.9982208013534546, 0.9950451254844666, 0.9962893128395081, 0.9920322895050049, 0.9777331948280334, 0.9797704219818115, 0.9880720376968384, 0.9873267412185669, 1.0196493864059448, 1.0119585990905762, 1.0297547578811646, 1.071064829826355, np.inf, np.inf, np.inf, np.inf, 2.0945188999176025, 2.03692364692688, 2.009464740753174, 2.0002152919769287, 1.9914616346359253, 1.9986283779144287, 2.0323102474212646, 2.058297634124756, 3.0754921436309814, 3.081066608428955, 3.0749683380126953, 3.1013498306274414, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf, np.inf]
# plt.polar(theta, r)